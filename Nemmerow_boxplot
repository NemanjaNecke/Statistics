import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Define the function to create boxplots for each column
def create_boxplots(data, title, filename):
    # Extract the columns
    elements = data.columns  # Column names from the dataframe
    
    # Create a figure with one subplot per column
    fig, axs = plt.subplots(1, len(elements), figsize=(5 * len(elements), 6))  # Adjust figure size
    
    # If there's only one column, axs is not iterable, wrap it in a list
    if len(elements) == 1:
        axs = [axs]
    
    # Set a title for the entire figure
    fig.suptitle(title, fontsize=16)
    
    # Loop through each column and plot the boxplot
    for ax, element in zip(axs, elements):
        sns.boxplot(y=data[element].dropna(), ax=ax)  # Drop NaN values for plotting
        ax.set_title(element)  # Set title for each subplot
    
    # Adjust layout and save the figure
    plt.tight_layout()
    plt.subplots_adjust(top=0.85)  # Adjust top spacing for the suptitle
    plt.savefig(filename)
    plt.close()

# Load your data from the uploaded file
file_path = "/mnt/data/file-H4WKDNDvSshBdt31JkjRQb"
data = pd.read_excel(file_path)

# Create boxplots
create_boxplots(data, "Boxplots for Columns", "boxplots_output.png")
